%!PS-Adobe-3.0
%%Creator: groff version 1.22.2
%%CreationDate: Tue Jan 26 19:22:28 2016
%%Title: lab5c-gdb-valgrind.ps
%%BoundingBox: 0 0 612 792
%%DocumentNeededResources: font Courier
%%+ font Courier-Bold
%%+ font NewCenturySchlbk-Bold
%%+ font NewCenturySchlbk-Roman
%%+ font NewCenturySchlbk-Italic
%%+ font Times-Roman
%%+ font NewCenturySchlbk-BoldItalic
%%DocumentSuppliedResources: procset grops 1.22 2
%%+ font Courier-Elite-Bold
%%+ font Courier-Elite
%%Pages: 9
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.22 2
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/Fr{
setrgbcolor fill
}bind def
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
/Fg{
setgray fill
}bind def
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Courier
%%IncludeResource: font Courier-Bold
%%IncludeResource: font NewCenturySchlbk-Bold
%%IncludeResource: font NewCenturySchlbk-Roman
%%IncludeResource: font NewCenturySchlbk-Italic
%%IncludeResource: font Times-Roman
%%IncludeResource: font NewCenturySchlbk-BoldItalic
%%BeginResource: font Courier-Elite-Bold
%%DocumentNeededResources: font Courier-Bold
/MakeTransformedFont{
findfont dup maxlength dict begin
{
exch dup dup/FID ne exch/UniqueID ne and{
exch def
}{
pop pop
}ifelse
}forall
/FontBBox
currentdict/FontBBox get
4 array copy def
FontBBox aload pop
4 index transform 4 2 roll
4 index transform 4 2 roll
FontBBox astore pop
FontMatrix exch matrix concatmatrix
/FontMatrix exch def
dup/FontName exch def
currentdict end
definefont pop
}bind def
/Courier-Elite-Bold
[ .833333333 0 0 1 0 0 ]
/Courier-Bold
MakeTransformedFont
%%EndResource
%%BeginResource: font Courier-Elite
%%DocumentNeededResources: font Courier
/MakeTransformedFont{
findfont dup maxlength dict begin
{
exch dup dup/FID ne exch/UniqueID ne and{
exch def
}{
pop pop
}ifelse
}forall
/FontBBox
currentdict/FontBBox get
4 array copy def
FontBBox aload pop
4 index transform 4 2 roll
4 index transform 4 2 roll
FontBBox astore pop
FontMatrix exch matrix concatmatrix
/FontMatrix exch def
dup/FontName exch def
currentdict end
definefont pop
}bind def
/Courier-Elite
[ .833333333 0 0 1 0 0 ]
/Courier
MakeTransformedFont
%%EndResource
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/NewCenturySchlbk-BoldItalic@0 ENC0/NewCenturySchlbk-BoldItalic RE
/Times-Roman@0 ENC0/Times-Roman RE/NewCenturySchlbk-Italic@0 ENC0
/NewCenturySchlbk-Italic RE/Courier-Elite-Bold@0 ENC0/Courier-Elite-Bold
RE/Courier-Elite@0 ENC0/Courier-Elite RE/NewCenturySchlbk-Roman@0 ENC0
/NewCenturySchlbk-Roman RE/NewCenturySchlbk-Bold@0 ENC0
/NewCenturySchlbk-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-012M \203 W)72 50 Q
(inter 2016 \203 Lab 5 \203 Debugging and memory leak)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(1o)34.548 G 3.336(f9)-3.336 G/F2 11
/Courier-Elite@0 SF
($Id: lab5c-gdb-valgrind.mm,v 1.55 2016-01-26 19:22:28-08 - - $)72 67 Q
(PWD: /afs/cats.ucsc.edu/courses/cmps012b-wm/Labs-cmps012m/lab5c-gdb-va\
lgrind)72 80 Q(URL: http://www2.ucsc.edu/courses/cmps012b-wm/:/Labs-cmp\
s012m/lab5c-gdb-valgrind/)72 93 Q F1 .916
(This lab will introduce you to)72 117 R/F3 12/Courier-Elite-Bold@0 SF
(gdb)4.252 E F1 4.251(,t)C .915(he Gnu debugger associated with)-4.251 F
F3(gcc)4.251 E F1 4.251(,a)C(nd)-4.251 E F3(val-)4.251 E(grind)72 131 Q
F1 5.128(,w)C(hic)-5.128 E 5.128(hc)-.084 G 1.792(an be used to trac)
-5.128 F 5.128(ku)-.084 G 1.792(ninitialized variables)-5.128 F 5.128
(,m)-.3 G 1.792(emory leak, and dan-)-5.128 F 1.107(gling pointers)72
145 R 7.779(.U)-.3 G 1.107(ninitialized variables are variables whic)
-7.779 F 4.442(ha)-.084 G 1.106(re dec)-4.442 F 1.106(lared but whose)
-.084 F 1.774(value is used before being assigned to)72 159 R 8.446(.M)
-.216 G 1.774(emory leak occurs when memory is not)-8.446 F 2.544
(freed when no longer needed)72 173 R 9.216(;C)2 G 2.543(does not ha)
-3.337 F 2.543(ve a garbage collector)-.12 F 9.215(.A)-1.2 G(dangling)
-3.336 E(pointer points at storage that has been freed and should no lo\
nger be accessed.)72 187 Q 1.461(Before beginning this lab)72 207 R
4.797(,s)-.216 G 1.462(tudy some of the tutorials in)-4.797 F F3
(Tutorials/gdb-tutorials)4.798 E F1(.)A 2.664
(There are links in this directory to)72 221 R F3
(gdb-tutorial-handout.pdf)6 E F1(and)6 E F3(gdb-tutorial-)6 E(ohio.html)
72 235 Q F1 3.47(,w)C(hic)-3.47 E 3.47(ha)-.084 G .135
(re fairly short, but also a link to)-3.47 F F3(gdb-tutorial-rms)3.471 E
F1 3.471(,w)C(hic)-3.471 E 3.471(hi)-.084 G 3.471(sm)-3.471 G(uc)-3.471
E(h)-.084 E(longer and more detailed.)72 249 Q F3
(http://www2.ucsc.edu/courses/cmps012b-wm/:/Labs-cmps012m/)72 269 Q
(lab5c-gdb-valgrind/gdb-tutorials/gdb-tutorial-ohio.html)72 283 Q F0
3.444(1. Use)72 309 R(of)3.444 E F3(script)3.444 E F1 2.623(In this lab)
72 329 R 5.959(,y)-.216 G 2.623(ou will follow some detailed steps)
-5.959 F 9.295(.F)-.3 G 2.623(or eac)-9.955 F 5.959(hs)-.084 G(tep)
-5.959 E 5.959(,s)-.216 G 2.622(ubmit the \214les)-5.959 F 4.33
(listed. After)72 343 R .994(you ha)4.33 F .994
(ve submitted the necessary \214les)-.12 F 4.33(,v)-.3 G .995
(erify that they are all in the)-4.33 F(submit directory by using)72 357
Q F3(ls)3.336 E F1 6.672(.A)C 3.336(si)-6.672 G 3.336(nap)-3.336 G
(revious lab)-3.336 E 3.336(,t)-.216 G(he command)-3.336 E F3
(grep Submit: *.tt)85.5 371 Q F1 .361
(will summarize the \214les you need to submit.)72 385 R .361
(Most of the commands will be interac-)7.033 F(tive)72 399 Q 3.681(,s)
-.216 G 3.681(om)-3.681 G .345(ake use of the)-3.681 F F3(script)3.681 E
F1 .346(command to capture command line output.)3.681 F 3.682(At)7.018 G
(ermi-)-3.682 E(nal session can be captured with)72 413 Q F3(script)85.5
427 Q/F4 12/NewCenturySchlbk-Italic@0 SF(\214lename)7.416 E F1(where)72
441 Q F4(\214lename)3.474 E F1 .138(is the \214le into whic)3.474 F
3.474(hy)-.084 G .138(ou w)-3.474 F .137(ant your session captured.)
-.216 F .137(Be sure not to)6.809 F 1.519
(use anything other than line mode commands in this \214le)72 455 R
4.855(,a)-.216 G 1.519(nd examine it after to)-4.855 F(verify this)72
469 Q 6.672(.S)-.3 G(peci\214cally)-6.672 E 3.336(,n)-1.5 G
(ever use an editor inside a terminal running)-3.336 E F3(script.)3.336
E F0 3.444(2. Detailed)72 495 R(steps)3.444 E F1 -.66(Fo)72 515 S .899
(llowing are the items for this lab).66 F 7.57(.C)-.216 G .898
(apture the output in the \214le speci\214ed at the)-7.57 F(end of eac)
72 529 Q 3.336(hp)-.084 G(art.)-3.336 E F0 -.66(Pa)72 549 S(rt \(01\).)
.66 E/F5 12/Times-Roman@0 SF 3.316(Ac)72 569 S .316
(ouple of uninitialized v)-3.316 F 3.316(ariables. F)-.3 F .316(or con)
-.18 F -.18(ve)-.48 G .316(nience, a script).18 F F3(mk)3.316 E F5 .316
(\(Figure 1\) has been pro)3.316 F .316(vided to)-.18 F -.24(avo)72 583
S 1.332(id the need for a).24 F F3(Makefile)4.332 E F5 1.332
(in this lab)4.332 F 7.332(.I)-.48 G 4.332(tc)-7.332 G 1.332
(ontains compilation instructions.)-4.332 F 1.332(Start with the)7.332 F
(program)72 597 Q F3(uninit.c)3 E F5 6(.\()C(Figure 2\).)-6 E
(Use the follo)6 E(wing commands.)-.3 E -1(Submit :)72 617 R F3
(part01.typescript)6 E 540 628 72 628 DL(mk uninit.c)78 639 Q F5
(Run the script to compile.)266 639 Q 540 644 72 644 DL F3
(valgrind uninit)78 655 Q F5(Check for uninitialized v)266 655 Q
(ariables.)-.3 E 540 660 72 660 DL F3(echo $?)78 671 Q F5(What is the e)
266 671 Q(xit status)-.18 E(?)2 E F3(bash)6 E F5
(will capture the crash.)3 E 540 676 72 676 DL F3(pstatus 139)78 687 Q
F5(Print the meaning of the crash.)266 687 Q 540 692 72 692 DL F3(exit)
78 703 Q F5(Get out of)266 703 Q F3(script)3 E F5(.)A 540 708 72 708 DL
540 628 540 708 DL 72 628 72 708 DL 257 628 257 708 DL 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-012M \203 W)72 50 Q
(inter 2016 \203 Lab 5 \203 Debugging and memory leak)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(2o)34.548 G 3.336(f9)-3.336 G F0 -.66
(Pa)72 74 S(rt \(02\).).66 E/F2 12/Times-Roman@0 SF(No)72 94 Q 3(wl)-.3
G(ook into your program with)-3 E/F3 12/Courier-Elite-Bold@0 SF(gdb)3 E
F2 3(,c)C(apturing your session into)-3 E F3(part02.script)3 E F2 -1
(Submit :)72 114 R F3(part02.typescript)6 E 540 125 72 125 DL
(gdb uninit)78 136 Q F2(Start)266 136 Q F3(gdb)3 E F2(.)A 540 141 72 141
DL F3(run)78 152 Q F2(Run the program.)266 152 Q 540 157 72 157 DL F3
(where)78 168 Q F2(Ask where in the program it crashed.)266 168 Q 540
173 72 173 DL F3(list)78 184 Q F2(Look at a fe)266 184 Q 3(wl)-.3 G
(ines around where it crashed.)-3 E 540 189 72 189 DL F3(print foo)78
200 Q F2(Print the v)266 200 Q(alues of some v)-.3 E(ariables.)-.3 E 540
205 72 205 DL F3(print pointer)78 216 Q 540 221 72 221 DL
(print *pointer)78 232 Q 540 237 72 237 DL(print argv[0])78 248 Q 540
253 72 253 DL(quit)78 264 Q F2(Quit)266 264 Q F3(gdb)3 E F2 6(.A)C
(nswer yes to the subprocess question.)-6 E 540 269 72 269 DL 540 125
540 269 DL 72 125 72 269 DL 257 125 257 269 DL F0 -.66(Pa)72 284 S
(rt \(03\).).66 E F2(No)72 304 Q 3(ws)-.3 G
(tep through the program a line at a time.)-3 E -1(Submit :)72 324 R F3
(part03.typescript)6 E 540 335 72 335 DL(gdb uninit)78 346 Q 540 351 72
351 DL(break main)78 362 Q F2(Set a breakpoint at the be)266 362 Q
(ginning of the main function.)-.18 E 540 367 72 367 DL F3(run)78 378 Q
F2(Note that it stops at the breakpoint.)266 378 Q 540 383 72 383 DL F3
(print foo)78 394 Q F2 .167(Note that the v)266 394 R .167
(alue is some number)-.3 F 3.167(,b)-.48 G .168(ut there is no w)-3.407
F(ay)-.12 E(to \214gure out wh)266 408 Q 3(yi)-.06 G 3(th)-3 G
(as this v)-3 E(alue.)-.3 E 540 413 72 413 DL F3(next)78 424 Q F2 1.503
(Step one statement, stepping o)266 424 R -.18(ve)-.18 G 2.462 -.48
(r, n).18 H 1.502(ot into, functions.).48 F 4.924(The command)266 438 R
F3(step)7.924 E F2 -.12(wo)7.924 G 4.924(uld step into the function).12
F(instead of o)266 452 Q -.18(ve)-.18 G 3(ri).18 G(t.)-3 E 540 457 72
457 DL F3(print pointer)78 468 Q 540 473 72 473 DL(next)78 484 Q F2
1.818(Step one more statement.)266 484 R 1.818
(Note that it crashes at this)7.818 F(point.)266 498 Q 540 503 72 503 DL
F3(quit)78 514 Q 540 519 72 519 DL 540 335 540 519 DL 72 335 72 519 DL
257 335 257 519 DL 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-012M \203 W)72 50 Q
(inter 2016 \203 Lab 5 \203 Debugging and memory leak)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(3o)34.548 G 3.336(f9)-3.336 G F0 -.66
(Pa)72 74 S(rt \(04\).).66 E/F2 12/Times-Roman@0 SF(No)72 94 Q 4.493(wl)
-.3 G 1.493(et look at)-4.493 F/F3 12/Courier-Elite-Bold@0 SF(malloc)
4.493 E F2 1.493(\(similar to Ja)4.493 F -.3(va)-.24 G -.66('s).3 G F3
(new)5.153 E F2 4.493(\)a)C(nd)-4.493 E F3(free)4.493 E F2 4.493(,w)C
1.493(hich releases storage.)-4.493 F 4.494(Cd)7.494 G 1.494(oes not)
-4.494 F(ha)72 108 Q .36 -.18(ve a g)-.24 H(arbage collector).12 E 6(.S)
-.66 G(tart with the program)-6 E F3(malloc.c)3 E F2(\(Figure 3\).)3 E
-1(Submit :)72 128 R F3(part04.typescript)6 E 540 139 72 139 DL
(valgrind malloc)78 150 Q F2 1.295(Note that there are a couple of)266
150 R F3(malloc)4.295 E F2 2.615 -.66('s b)D 1.295(ut only one).42 F F3
(free)266 164 Q F2(later)3 E 6(.S)-.66 G 3(oo)-6 G(ne block w)-3 E
(as leak)-.12 E(ed.)-.12 E 540 169 72 169 DL F3(gdb malloc)78 180 Q 540
185 72 185 DL(break main)78 196 Q F2
(Set a breakpoint in the main function.)266 196 Q 540 201 72 201 DL F3
(run)78 212 Q 540 217 72 217 DL(print ptr)78 228 Q 540 233 72 233 DL
(print *ptr)78 244 Q F2(Bad memory access because)266 244 Q F3(ptr)3 E
F2(is not initialized.)3 E 540 249 72 249 DL F3(next)78 260 Q 540 265 72
265 DL(print ptr)78 276 Q F2(No)266 276 Q(w)-.3 E F3(ptr)3 E F2(has a v)
3 E(alue obtained from the heap.)-.3 E 540 281 72 281 DL F3(print *ptr)
78 292 Q F2 .662(But the v)266 292 R .662
(alue it points it is uninitialized.)-.3 F .663(If it is 0, that)6.662 F
(is just a coincidence.)266 306 Q 540 311 72 311 DL F3(next)78 322 Q 540
327 72 327 DL(next)78 338 Q 540 343 72 343 DL(next)78 354 Q 540 359 72
359 DL(print ptr)78 370 Q 540 375 72 375 DL(print *ptr)78 386 Q F2(No)
266 386 Q 3(wi)-.3 G 3(tp)-3 G(oints at initialized storage.)-3 E 540
391 72 391 DL F3(next)78 402 Q F2(The storage is freed by the call to)
266 402 Q F3(free)3 E F2(.)A 540 407 72 407 DL F3(next)78 418 Q 540 423
72 423 DL(next)78 434 Q 540 439 72 439 DL(next)78 450 Q F2 3.341
(The reference to)266 450 R F3(__libc_start_main)6.341 E F2 3.34
(is the startup)6.341 F 1.966
(function called by the operating system to set up the)266 464 R(en)266
478 Q(vironment and call main.)-.48 E 540 483 72 483 DL F3(quit)78 494 Q
540 499 72 499 DL 540 139 540 499 DL 72 139 72 499 DL 257 139 257 499 DL
F0 -.66(Pa)72 514 S(rt \(05\).).66 E F2(Examine)72 534 Q F3(list1.c)
3.633 E F2 .633(\(Figure 4\).)3.633 F .633(Compile it with)6.633 F F3
.633(mk list1.c)3.633 F F2 .633(and look at the errors and w)3.633 F
(arnings)-.12 E .468(you see.)72 548 R .469
(Capture the output from this compilation and submit it.)6.468 F .469
(Read the man page)6.469 F F3(malloc)3.469 E F2(\(3\))A
(to see what header \214le w)72 562 Q(as not included.)-.12 E -1
(Submit :)72 582 R F3(part05.typescript)6 E 0 Cg EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-012M \203 W)72 50 Q
(inter 2016 \203 Lab 5 \203 Debugging and memory leak)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(4o)34.548 G 3.336(f9)-3.336 G F0 -.66
(Pa)72 74 S(rt \(06\).).66 E/F2 12/Times-Roman@0 SF(Cop)72 94 Q(y)-.12 E
/F3 12/Courier-Elite-Bold@0 SF(list1.c)3 E F2(to)3 E F3(list2.c)3 E F2
(and \214x the missing header \214le.)3 E(Capture the output.)6 E -1
(Submit :)72 114 R F3(part06.typescript)6 E F2 -1(Submit :)72 134 R F3
(list2.c)6 E 556 145 72 145 DL(mk list2.c)78 156 Q 556 161 72 161 DL
(valgrind list2 foo bar)78 172 Q F2 4.225(Note the complaints from)282
172 R F3(valgrind)7.225 E F2 10.224(.I)C 7.224(tc)-10.224 G(omplains)
-7.224 E 2.589(about memory leak, b)282 186 R 2.59(ut also about in)-.24
F -.3(va)-.48 G 2.59(lid access to).3 F(memory)282 200 Q(.)-.78 E 556
205 72 205 DL F3(gdb list2)78 216 Q 556 221 72 221 DL(break)78 232 Q/F4
12/NewCenturySchlbk-Italic@0 SF(n)6.432 E F2 1.014
(Set a breakpoint at line)282 232 R F4(n)4.446 E F2 4.014(,w).012 G
(here)-4.014 E F4(n)4.446 E F2 1.013(is the line number)4.026 F(of the)
282 246 Q F3(return)3 E F2(statement.)3 E 556 251 72 251 DL F3
(run foo bar)78 262 Q F2 .071(Note ho)282 262 R 3.071(wa)-.3 G -.216(rg)
-3.071 G .071(uments are gi).216 F -.18(ve)-.3 G 3.071(nt).18 G 3.071
(oap)-3.071 G .071(rogram, on the)-3.071 F F3(run)3.072 E F2
(not on the in)282 276 Q -.24(vo)-.48 G(cation of).24 E F3(gdb)3 E F2(.)
A 556 281 72 281 DL F3(where)78 292 Q 556 297 72 297 DL(list)78 308 Q F2
(List the lines around the point of the crash.)282 308 Q 556 313 72 313
DL F3(list list2.c:23)78 324 Q F2 1.92 -.96(We c)282 324 T
(an select the particular set of lines to list.).96 E 556 329 72 329 DL
F3(print head)78 340 Q F2 3.202(Not in the current stack frame.)282 340
R 3.201(Note that we ha)9.202 F -.18(ve)-.24 G(called se)282 354 Q -.18
(ve)-.3 G(ral library functions, as sho).18 E(wn by)-.3 E F3(where)3 E
F2(.)A 556 359 72 359 DL F3(bt)78 370 Q F2 3(Ab)282 370 S
(acktrace is another w)-3 E(ay of looking at the stack.)-.12 E 556 375
72 375 DL F3(print head)78 386 Q F2(No)282 386 Q 3(ww)-.3 G 3(ea)-3 G
(re in the correct frame.)-3 E 556 391 72 391 DL F3(print *head)78 402 Q
556 407 72 407 DL(print *\(head->word\))78 418 Q F2 1.92 -.96(We c)282
418 T(an use more complicated C e).96 E(xpressions.)-.18 E 556 423 72
423 DL F3(print head->link->link->link)78 434 Q 556 439 72 439 DL
(print *\(head->link->link->link\))78 450 Q 556 455 72 455 DL 556 145
556 455 DL 72 145 72 455 DL 273 145 273 455 DL 0 Cg EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-012M \203 W)72 50 Q
(inter 2016 \203 Lab 5 \203 Debugging and memory leak)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(5o)34.548 G 3.336(f9)-3.336 G F0 -.66
(Pa)72 74 S(rt \(07\).).66 E/F2 12/Times-Roman@0 SF(Run)72 94 Q/F3 12
/Courier-Elite-Bold@0 SF(list2)3 E F2(ag)3 E(ain, sho)-.06 E(wing v)-.3
E(alues in)-.3 E F3(argv)3 E F2(.)A -1(Submit :)72 114 R F3
(part07.typescript)6 E 540 125 72 125 DL(gdb list2)78 136 Q 540 141 72
141 DL(break main)78 152 Q 540 157 72 157 DL(run foo bar)78 168 Q F2
2.051(Run the program with tw)266 168 R 5.051(oc)-.12 G 2.051
(ommand line ar)-5.051 F(guments,)-.216 E(namely)266 182 Q F3(foo)3 E F2
(and)3 E F3(bar)3 E F2(.)A 540 187 72 187 DL F3(print argc)78 198 Q 540
203 72 203 DL(print argv)78 214 Q 540 219 72 219 DL(print argv[0])78 230
Q(argv[0])266 230 Q F2(is al)3 E -.12(wa)-.12 G
(ys the name of the program being run.).12 E 540 235 72 235 DL F3
(print argv[1])78 246 Q 540 251 72 251 DL(print argv[2])78 262 Q 540 267
72 267 DL(print argv[3])78 278 Q(argv[argc])266 278 Q F2 1.537(is al)
4.537 F -.12(wa)-.12 G 1.537(ys the null pointer).12 F 4.536(,r)-.48 G
1.536(epresented as)-4.536 F F3(0x0)266 292 Q F2(in C.)3 E 540 297 72
297 DL F3(print argv[4])78 308 Q F2(After)266 308 Q F3(argv)4.83 E F2
1.83(is the def)4.83 F 1.831(ault en)-.12 F 1.831
(vironment which you can)-.48 F(display using the)266 322 Q F3(env)3 E
F2(or)3 E F3(printenv)3 E F2(command.)3 E 540 327 72 327 DL F3
(print argv[5])78 338 Q 540 343 72 343 DL(print argv[6])78 354 Q 540 359
72 359 DL 540 125 540 359 DL 72 125 72 359 DL 257 125 257 359 DL F0 -.66
(Pa)72 374 S(rt \(08\).).66 E F2(Cop)72 394 Q(y)-.12 E F3(list2.c)3.363
E F2(to)3.363 E F3(list3.c)3.363 E F2 .363(and use)3.363 F F3(valgrind)
3.363 E F2(and)3.363 E F3(gdb)3.363 E F2 .363
(as appropriate so that you can track do)3.363 F(wn)-.3 E .829
(and \214x all of the memory f)72 408 R 3.829(aults. Ignore)-.12 F .83
(memory leak for no)3.829 F 5.39 -.78(w. T)-.3 H .83
(he backslash in the command).78 F(belo)72 422 Q 4.266(wi)-.3 G 4.266
(sj)-4.266 G 1.266
(ust for typographical reasons, to get the command within the box')
-4.266 F 4.265(sw)-.66 G 4.265(idth. Y)-4.265 F 1.265(ou may)-1.32 F
(type the entire command on one line.)72 436 Q -1(Submit :)72 456 R F3
(part08.typescript)6 E F2 -1(Submit :)72 476 R F3(list3.c)6 E 540 487 72
487 DL(valgrind --leak-check=full \\)78 498 Q(list3 foo bar baz qux)78
512 Q F2(Run)266 498 Q F3(valgrind)3.665 E F2 .665(with the option)3.665
F F3(--leak-check=full)3.664 E F2(to)3.664 E -.18(ve)266 512 S .096
(rify that your program in f).18 F .097(act has no problems e)-.12 F
(xcept)-.18 E(leaks.)266 526 Q 540 531 72 531 DL 540 487 540 531 DL 72
487 72 531 DL 257 487 257 531 DL F0 -.66(Pa)72 546 S(rt \(09\).).66 E F2
(Cop)72 566 Q(y)-.12 E F3(list3.c)3.886 E F2(to)3.886 E F3(list4.c)3.886
E F2 6.886(.E)C .886(liminate memory leak by using)-6.886 F F3(free)
3.885 E F2 .885(to release all allocated stor)3.885 F(-)-.24 E(age.)72
580 Q -1(Submit :)72 600 R F3(part09.typescript)6 E F2 -1(Submit :)72
620 R F3(list4.c)6 E 540 631 72 631 DL(valgrind --leak-check=full \\)78
642 Q(list4 foo bar baz qux)78 656 Q F2 -1.332(Ve)266 642 S 1.307
(rify that your program no)1.332 F 4.307(ww)-.3 G 1.307
(orks with no memory)-4.427 F -.12(fa)266 656 S
(ults and no memory leak.).12 E 540 661 72 661 DL F3(echo $?)78 672 Q F2
(Mak)266 672 Q 3(es)-.12 G(ure the e)-3 E(xit status is)-.18 E F3
(EXIT_SUCCESS)3 E F2(.)A 540 677 72 677 DL 540 631 540 677 DL 72 631 72
677 DL 257 631 257 677 DL 0 Cg EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-012M \203 W)72 50 Q
(inter 2016 \203 Lab 5 \203 Debugging and memory leak)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(6o)34.548 G 3.336(f9)-3.336 G F0 -.66
(Pa)72 74 S(rt \(10\).).66 E/F2 12/Times-Roman@0 SF
(Write a program called)72 94 Q/F3 12/Courier-Elite-Bold@0 SF(environ.c)
3 E F2(which will declare the e)3 E(xternal v)-.18 E(ariable)-.3 E F3
(extern char **environ;)85.5 108 Q F2 .392(and write a loop iterating o)
72 122 R -.18(ve)-.18 G 3.392(rt).18 G .392(hat array)-3.392 F 3.392(,p)
-.78 G .392(rinting each element per line.)-3.392 F .392
(The stopping condition)6.392 F(is meeting a null pointer)72 136 Q 3(,a)
-.48 G 3(st)-3 G(here is no v)-3 E(ariable indicating ho)-.3 E 3(wl)-.3
G(ar)-3 E(ge the array is.)-.216 E -1(Submit :)72 156 R F3
(part10.typescript)6 E F2 -1(Submit :)72 176 R F3(environ.c)6 E 540 187
72 187 DL(./environ)78 198 Q F2(Print out all your en)266 198 Q
(vironment v)-.48 E(ariables.)-.3 E 540 203 72 203 DL 540 187 540 203 DL
72 187 72 203 DL 257 187 257 203 DL F0 3.444(3. What)72 224 R(to submit)
3.444 E F1 1.611(Submit the 14 \214les mentioned above)72 244 R 8.283
(.I)-.216 G 4.947(fy)-8.283 G 1.611(ou are doing pair programming)-4.947
F 4.947(,s)-.3 G(ubmit)-4.947 E(the required \214les as well.)72 258 Q
F0 3.444(4. Debugging)72 284 R(with)3.444 E F3(ddd)3.444 E F1 1.204
(An alternative to)72 304 R F3(gdb)4.54 E F1(is)4.54 E F3(ddd)4.54 E F1
4.54(,w)C(hic)-4.54 E 4.54(hi)-.084 G 4.54(saG)-4.54 G 1.204
(UI wrapper around)-4.54 F F3(gdb)4.54 E F1 7.876(.I)C 4.541(ti)-7.876 G
4.541(sn)-4.541 G 1.205(ot part of)-4.541 F 2.676
(this lab and there is nothing to submit from using)72 318 R F3(ddd)
6.012 E F1 6.012(,b)C 2.676(ut you might w)-6.012 F 2.676(ant to)-.216 F
(explore it.)72 332 Q -.66(Fo)6.672 G 3.336(re).66 G -1.336(xample :)
-3.336 F 2.664(\(1\) Start)81.336 352 R -1.336(with :)3.539 F F3 .203
(ddd uninit &)6.875 F F1 6.875(.T)C .203(he ampersand \()-6.875 F F3(&)A
F1 3.539(\)a)C 3.54(tt)-3.539 G .204(he end of the line causes the)-3.54
F .209(program to be run in the bac)102 366 R 3.544(kground. If)-.084 F
.208(you are using a terminal without X11)3.544 F(forw)102 380 Q
(arding this will not work.)-.216 E 2.664(\(2\) In)81.336 400 R(the)
5.247 E F3(gdb)5.247 E F1(window)5.247 E 5.247(,t)-1.5 G -1.336(ype :)
-5.247 F F3 1.912(break main)8.584 F F1 8.584(.N)C 1.912
(ote that a stop sign appears in the)-8.584 F(code)102 414 Q(.)-.216 E
2.664(\(3\) Then)81.336 434 R -1.336(type :)3.336 F F3(run)6.672 E F1
6.672(.A)C 3.336(na)-6.672 G(rrow shows the breakpoint.)-3.336 E 2.664
(\(4\) Clic)81.336 454 R 3.336(ko)-.084 G(n)-3.336 E/F4 12
/NewCenturySchlbk-BoldItalic@0 SF(Ste)3.336 E(p)-.132 E F1
(several times)3.336 E(.)-.3 E 2.664(\(5\) Y)81.336 474 R(ou ma)-1.2 E
3.336(ya)-.12 G(lso use print statements in the)-3.336 E F3(gdb)3.336 E
F1(window to examine variables)3.336 E(.)-.3 E F0 3.444(5. Debugging)72
500 R(with)3.444 E F3(gdbtui)3.444 E F1 .676(There is also a program)72
520 R F3(gdbtui)4.011 E F1(whic)4.011 E 4.011(hi)-.084 G 4.011(st)-4.011
G .675(he text user interface to)-4.011 F F3(gdb)4.011 E F1 4.011(,w)C
(hic)-4.011 E 4.011(hw)-.084 G(orks)-4.011 E
(in a terminal window in full screen mode)72 534 Q 6.672(.Y)-.216 G
(ou might like to try that as well.)-7.872 E 0 Cg EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-012M \203 W)72 50 Q
(inter 2016 \203 Lab 5 \203 Debugging and memory leak)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(7o)34.548 G 3.336(f9)-3.336 G/F2 12
/Courier-Elite@0 SF 12(1#)108 102 S(!/bin/sh)-12 E 12(2#)108 116 S
($Id: mk,v 1.9 2014-04-30 17:37:19-07 - - $)-6 E 12(3#)108 130 S 12(4#)
108 144 S
(This script takes the names of C source files and compiles them)-6 E 12
(5#)108 158 S(into executable images.)-6 E
(Each source must be a complete program.)12 E 12(6#)108 172 S(7)108 186
Q 12(8e)108 200 S
(xport PATH=$PATH:/afs/cats.ucsc.edu/courses/cmps012b-wm/bin)-12 E 12
(9G)108 214 S(CC='gcc -g -O0 -Wall -Wextra -std=gnu99')-12 E(10)102 228
Q 6(11 for)102 242 R(CSOURCE in *.c)6 E 6(12 do)102 256 R 24
(13 EXECBIN=${CSOURCE%.c})102 270 R 24(14 if)102 284 R 6([")6 G
($CSOURCE" == "$EXECBIN" ])-6 E 24(15 then)102 298 R 42(16 echo)102 312
R($0: $CSOURCE: is not a C source file)6 E 24(17 else)102 326 R 42
(18 echo)102 340 R(CSOURCE=$CSOURCE EXECBIN=$EXECBIN)6 E 42(19 set)102
354 R(-x)6 E 42(20 cid)102 368 R 6(+$)6 G(CSOURCE)-6 E 42
(21 checksource)102 382 R($CSOURCE)6 E 42(22 $GCC)102 396 R
($CSOURCE -o $EXECBIN -lm 2>&1 | tee $CSOURCE.log 2>&1)6 E 42(23 set)102
410 R(+x)6 E 42(24 echo)102 424 R
(============================================================)6 E 24
(25 fi)102 438 R 6(26 done)102 452 R(27)102 466 Q 540 483 72 483 DL 540
77 540 483 DL 72 77 540 77 DL 72 483 72 77 DL F0 -.216(Fi)253.944 502.8
S(gure 1.).216 E/F3 12/Courier-Elite-Bold@0 SF(code/mk)6.888 E F2 12(1/)
108 550.8 S 6(/$)-12 G(Id: uninit.c,v 1.3 2014-02-18 15:08:14-08 - - $)
-6 E(2)108 564.8 Q 12(3#)108 578.8 S(include <stdio.h>)-12 E 12(4#)108
592.8 S(include <stdlib.h>)-12 E(5)108 606.8 Q 12(6i)108 620.8 S
(nt main \(int argc, char **argv\) {)-12 E 30(7i)108 634.8 S
(nt *pointer;)-30 E 30(8p)108 648.8 S
(rintf \("pointer=%p\\n", pointer\);)-30 E 30(9p)108 662.8 S
(rintf \("*pointer=%d\\n", *pointer\);)-30 E 24(10 int)102 676.8 R(foo;)
6 E 24(11 printf)102 690.8 R(\("foo=%d\\n", foo\);)6 E 6(12 })102 704.8
R 540 721.8 72 721.8 DL 540 525.8 540 721.8 DL 72 525.8 540 525.8 DL 72
721.8 72 525.8 DL 0 Cg EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-012M \203 W)72 50 Q
(inter 2016 \203 Lab 5 \203 Debugging and memory leak)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(8o)34.548 G 3.336(f9)-3.336 G F0
-.216(Fi)235.944 74 S(gure 2.).216 E/F2 12/Courier-Elite-Bold@0 SF
(code/uninit.c)6.888 E/F3 12/Courier-Elite@0 SF 12(1/)108 122 S 6(/$)-12
G(Id: malloc.c,v 1.2 2013-02-08 18:01:12-08 - - $)-6 E(2)108 136 Q 12
(3#)108 150 S(include <stdio.h>)-12 E 12(4#)108 164 S
(include <stdlib.h>)-12 E(5)108 178 Q 12(6t)108 192 S
(ypedef struct node node;)-12 E 12(7s)108 206 S(truct node {)-12 E 30
(8i)108 220 S(nt value;)-30 E 30(9n)108 234 S(ode *link;)-30 E 6(10 };)
102 248 R(11)102 262 Q 6(12 int)102 276 R
(main \(int argc, char **argv\) {)6 E 24(13 node)102 290 R
(*ptr = malloc \(sizeof \(struct node\)\);)6 E 24(14 ptr)102 304 R 6(=m)
6 G(alloc \(sizeof \(node\)\);)-6 E 24(15 ptr->value)102 318 R 6(=6)6 G
(;)-6 E 24(16 ptr->link)102 332 R 6(=N)6 G(ULL;)-6 E 24(17 printf)102
346 R(\("%p-> {%d, %p}\\n", ptr, ptr->value, ptr->link\);)6 E 24
(18 free)102 360 R(\(ptr\);)6 E 24(19 return)102 374 R(EXIT_SUCCESS;)6 E
6(20 })102 388 R 540 405 72 405 DL 540 97 540 405 DL 72 97 540 97 DL 72
405 72 97 DL F0 -.216(Fi)235.944 424.8 S(gure 3.).216 E F2
(code/malloc.c)6.888 E 0 Cg EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
.48 LW 540 54 72 54 DL 540 56 72 56 DL/F0 12/NewCenturySchlbk-Bold@0 SF
(CMPS-012M \203 W)72 50 Q
(inter 2016 \203 Lab 5 \203 Debugging and memory leak)-.216 E/F1 12
/NewCenturySchlbk-Roman@0 SF 3.336(9o)34.548 G 3.336(f9)-3.336 G/F2 12
/Courier-Elite@0 SF 12(1/)108 102 S 6(/$)-12 G
(Id: list1.c,v 1.3 2013-02-08 18:00:41-08 - - $)-6 E(2)108 116 Q 12(3#)
108 130 S(include <assert.h>)-12 E 12(4#)108 144 S(include <stdio.h>)-12
E(5)108 158 Q 12(6t)108 172 S(ypedef struct node node;)-12 E 12(7s)108
186 S(truct node {)-12 E 30(8c)108 200 S(har *word;)-30 E 30(9n)108 214
S(ode *link;)-30 E 6(10 };)102 228 R(11)102 242 Q 6(12 int)102 256 R
(main \(int argc, char **argv\) {)6 E 24(13 node)102 270 R(*head;)6 E 24
(14 for)102 284 R(\(int argi = 0; argi < 5; ++argi\) {)6 E 42(15 node)
102 298 R(*node = malloc \(sizeof \(struct node\)\);)6 E 42(16 assert)
102 312 R(\(node != NULL\);)6 E 42(17 node->word)102 326 R 6(=a)6 G
(rgv[argi];)-6 E 42(18 node->link)102 340 R 6(=h)6 G(ead;)-6 E 42
(19 head)102 354 R 6(=n)6 G(ode;)-6 E 24(20 })102 368 R 24(21 for)102
382 R(\(node *curr = head; curr->link != NULL; curr = curr->link\) {)6 E
42(22 printf)102 396 R(\("%p->node {word=%p->[%s], link=%p}\\n",)6 E 90
(23 curr,)102 410 R(curr->word, curr->word, curr->link\);)6 E 24(24 })
102 424 R 24(25 return)102 438 R(9;)6 E 6(26 })102 452 R 540 469 72 469
DL 540 77 540 469 DL 72 77 540 77 DL 72 469 72 77 DL F0 -.216(Fi)238.944
488.8 S(gure 4.).216 E/F3 12/Courier-Elite-Bold@0 SF(code/list1.c)6.888
E 0 Cg EP
%%Trailer
end
%%EOF
